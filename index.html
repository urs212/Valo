<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>이메일 인증 시스템</title>
<style>
  body { font-family: Arial, sans-serif; padding: 20px; }
  input { padding: 5px; margin: 5px 0; width: 250px; }
  button { padding: 5px 10px; margin-left: 5px; }
  #status { margin-top: 10px; font-weight: bold; }
</style>
<!-- EmailJS 최신 SDK v4 -->
<script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
</head>
<body>

<h2>이메일 인증</h2>

<div>
    <input type="email" id="email" placeholder="이메일 입력">
    <button id="sendBtn">인증 코드 전송</button>
</div>

<div>
    <input type="text" id="code" placeholder="인증 코드 입력">
    <button id="verifyBtn">인증 확인</button>
</div>

<div id="status"></div>

<script>
  // EmailJS 초기화
  emailjs.init("PXy5dWLVSSQbQwKCj");

  let currentCode = "";

  const statusDiv = document.getElementById("status");

  // 인증 코드 전송
  document.getElementById("sendBtn").addEventListener("click", async function() {
      const email = document.getElementById("email").value.trim();
      if (!email) return alert("이메일을 입력해주세요.");

      // 6자리 랜덤 인증 코드 생성
      currentCode = Math.floor(100000 + Math.random() * 900000).toString();

      const templateParams = {
          to_email: email,
          verification_code: currentCode
      };

      try {
          await emailjs.send('service_y439lcp', 'template_zksqn5c', templateParams);
          statusDiv.style.color = "green";
          statusDiv.textContent = `인증 코드가 ${email}로 발송되었습니다.`;
      } catch (err) {
          console.error(err);
          statusDiv.style.color = "red";
          statusDiv.textContent = "이메일 전송 실패. 콘솔 확인";
      }
  });

  // 인증 코드 확인
  document.getElementById("verifyBtn").addEventListener("click", function() {
      const inputCode = document.getElementById("code").value.trim();
      if (!inputCode) return alert("코드를 입력해주세요.");

      if (inputCode === currentCode) {
          statusDiv.style.color = "green";
          statusDiv.textContent = "인증 성공!";
      } else {
          statusDiv.style.color = "red";
          statusDiv.textContent = "인증 실패!";
      }
  });
</script>

</body>
</html>
